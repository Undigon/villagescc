{% extends "home_base.html" %}

{% block title %}My Relationships{% endblock %}

{% block nav_relationships_class %}selected{% endblock %}

{% block content %}
<h2>My Relationships</h2>

<div class="feature">
	<h3 class="first">Summary</h3>
	{% include "relationships_summary.html" %}
</div>


{% if accounts %}
<h3>Details</h3>

{# TODO: Make this table sortable with jquery. #}

<table class="data">
	<tr>
		<th>Name</th>
		<th class="number_header">Their Endorsement of You</th>
		<th class="number_header">Hours Owed to Them</th>
		<th class="number_header">Hours Owed to You</th>
		<th class="number_header">Your Endorsement of Them</th>
		<th class="number_header" 
			title="Credit remaining as a percentage of endorsement">Health</th>
	</tr>
	{% for account in accounts %}
		<tr>
			<td><a href="{{ account.partner.get_absolute_url }}"
				   title="View Profile for {{ account.partner }}"
				   >{{ account.partner }}</a></td>
			<td class="number">
				{% if account.partner_endorsement %}
					<a href="{{ account.partner_endorsement.get_absolute_url }}"
					   title="View Endorsement from {{ account.partner }}"
					   >{{ account.out_limit }}</a>
				{% endif %}
			</td>
			<td class="number">
				<a href="{% url relationship account.partner.username %}"
				   title="View Relationship with {{ account.partner }}"
				   >{{ account.owed_to_them|default_if_none:"" }}</a></td>
			<td class="number">
				<a href="{% url relationship account.partner.username %}"
				   title="View Relationship with {{ account.partner }}"
				   >{{ account.owed_to_you|default_if_none:"" }}</a></td>
			<td class="number">
				{% if account.endorsement %}
					<a href="{{ account.endorsement.get_absolute_url }}"
					   title="View Your Endorsement of {{ account.partner }}"
					   >{{ account.in_limit }}</a>
				{% else %}
					<a href="{% url endorse_user account.partner.username %}"
					   title="Endorse {{ account.partner }}">0</a>
				{% endif %}
			</td>
			<td class="number">{{ account.health }}</td>
		</tr>
	{% endfor %}
</table>
{% else %}
	<p><em>No relationships yet.</em></p>
{% endif %}

{% endblock %}
